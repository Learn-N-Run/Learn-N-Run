<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="article.three.dao.MainReadDAO">
	<select id="TopClassSelect" resultType="PopularClassDTO">
		<![CDATA[
			SELECT cl.no 'classNo',cl.cre_id 'creator',cl.cover_img 'coverImg',cl.title 'title',ca.no 'categoryNo', ca.name 'categoryName', 
				count(*) 'topRankCount'
			FROM class cl JOIN category ca JOIN buyer buy
			ON cl.category_no=ca.no
				AND cl.no = buy.class_no
			WHERE ca.name LIKE #{categoryName}
			GROUP BY cl.no
			LIMIT 5;
		]]>
	</select>
	
	<select id="InterestedClassSelect" resultType="InterestedClassDTO">
		<![CDATA[
			SELECT cl.no 'classNo',cl.cre_id 'creator',cl.cover_img 'coverImg',cl.title 'title',ca.no 'categoryNo', ca.name 'categoryName', 
				count(*) 'interestedCount' 
			FROM class cl JOIN category ca JOIN jjim jj
			ON cl.category_no=ca.no
				AND cl.no = jj.class_no
			WHERE ca.name LIKE #{categoryName}
			GROUP BY cl.no
			LIMIT 5;		
		]]>
	</select>

	<select id="CategorySelect" resultType="CategoryDTO">
		<![CDATA[
			SELECT * FROM category
		]]>
	</select>
	<select id="CategoryClassSelect" parameterType="String" resultType="ClassDTO">
		<![CDATA[
			SELECT cl.no 'no', cl.cre_id 'creator', cl.cover_img 'cover_img', cl.title 'title', cl.content 'content'
			FROM class cl JOIN category ca
			ON cl.category_no = ca.no
			WHERE ca.name = #{cate};
		]]>
	</select>
</mapper>